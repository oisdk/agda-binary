<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Binary.Conversion.Fast</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">module</a> <a id="44" href="Data.Binary.Conversion.Fast.html" class="Module">Data.Binary.Conversion.Fast</a> <a id="72" class="Keyword">where</a>

<a id="79" class="Comment">-- This module provides a conversion function from</a>
<a id="130" class="Comment">-- nats which uses built-in functions.</a>
<a id="169" class="Comment">-- It is dramatically faster than the normal conversion</a>
<a id="225" class="Comment">-- even at smaller numbers.</a>

<a id="254" class="Keyword">open</a> <a id="259" class="Keyword">import</a> <a id="266" href="Data.Binary.Definition.html" class="Module">Data.Binary.Definition</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="318" class="Keyword">open</a> <a id="323" class="Keyword">import</a> <a id="330" href="Agda.Builtin.Bool.html" class="Module">Agda.Builtin.Bool</a>

<a id="even"></a><a id="349" href="Data.Binary.Conversion.Fast.html#349" class="Function">even</a> <a id="354" class="Symbol">:</a> <a id="356" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a> <a id="360" class="Symbol">→</a> <a id="362" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="367" href="Data.Binary.Conversion.Fast.html#349" class="Function">even</a> <a id="372" href="Data.Binary.Conversion.Fast.html#372" class="Bound">n</a> <a id="374" class="Symbol">=</a> <a id="376" href="Agda.Builtin.Nat.html#3029" class="Primitive">mod-helper</a> <a id="387" class="Number">0</a> <a id="389" class="Number">1</a> <a id="391" href="Data.Binary.Conversion.Fast.html#372" class="Bound">n</a> <a id="393" class="Number">1</a> <a id="395" href="Agda.Builtin.Nat.html#620" class="Primitive Operator">==</a> <a id="398" class="Number">0</a>

<a id="div2"></a><a id="401" href="Data.Binary.Conversion.Fast.html#401" class="Function">div2</a> <a id="406" class="Symbol">:</a> <a id="408" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a> <a id="412" class="Symbol">→</a> <a id="414" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a>
<a id="418" href="Data.Binary.Conversion.Fast.html#401" class="Function">div2</a> <a id="423" href="Data.Binary.Conversion.Fast.html#423" class="Bound">n</a> <a id="425" class="Symbol">=</a> <a id="427" href="Agda.Builtin.Nat.html#1526" class="Primitive">div-helper</a> <a id="438" class="Number">0</a> <a id="440" class="Number">1</a> <a id="442" href="Data.Binary.Conversion.Fast.html#423" class="Bound">n</a> <a id="444" class="Number">1</a>

<a id="447" class="Keyword">infixr</a> <a id="454" class="Number">2</a> <a id="456" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">if_then_else_</a>
<a id="if_then_else_"></a><a id="470" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">if_then_else_</a> <a id="484" class="Symbol">:</a> <a id="486" class="Symbol">∀</a> <a id="488" class="Symbol">{</a><a id="489" href="Data.Binary.Conversion.Fast.html#489" class="Bound">a</a><a id="490" class="Symbol">}</a> <a id="492" class="Symbol">{</a><a id="493" href="Data.Binary.Conversion.Fast.html#493" class="Bound">A</a> <a id="495" class="Symbol">:</a> <a id="497" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="501" href="Data.Binary.Conversion.Fast.html#489" class="Bound">a</a><a id="502" class="Symbol">}</a> <a id="504" class="Symbol">→</a> <a id="506" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="511" class="Symbol">→</a> <a id="513" href="Data.Binary.Conversion.Fast.html#493" class="Bound">A</a> <a id="515" class="Symbol">→</a> <a id="517" href="Data.Binary.Conversion.Fast.html#493" class="Bound">A</a> <a id="519" class="Symbol">→</a> <a id="521" href="Data.Binary.Conversion.Fast.html#493" class="Bound">A</a>
<a id="523" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">if</a> <a id="526" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="532" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">then</a> <a id="537" href="Data.Binary.Conversion.Fast.html#537" class="Bound">t</a> <a id="539" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">else</a> <a id="544" class="Symbol">_</a> <a id="546" class="Symbol">=</a> <a id="548" href="Data.Binary.Conversion.Fast.html#537" class="Bound">t</a>
<a id="550" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">if</a> <a id="553" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="559" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">then</a> <a id="564" class="Symbol">_</a> <a id="566" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">else</a> <a id="571" href="Data.Binary.Conversion.Fast.html#571" class="Bound">f</a> <a id="573" class="Symbol">=</a> <a id="575" href="Data.Binary.Conversion.Fast.html#571" class="Bound">f</a>

<a id="⟦_⇑⟧⟨_⟩"></a><a id="578" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟦_⇑⟧⟨_⟩</a> <a id="586" class="Symbol">:</a> <a id="588" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a> <a id="592" class="Symbol">→</a> <a id="594" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a> <a id="598" class="Symbol">→</a> <a id="600" href="Data.Binary.Definition.html#96" class="Datatype">𝔹</a>
<a id="602" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟦</a> <a id="604" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="608" href="Data.Binary.Conversion.Fast.html#608" class="Bound">n</a> <a id="610" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⇑⟧⟨</a> <a id="614" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="618" href="Data.Binary.Conversion.Fast.html#618" class="Bound">w</a> <a id="620" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟩</a> <a id="622" class="Symbol">=</a>
  <a id="626" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">if</a> <a id="629" href="Data.Binary.Conversion.Fast.html#349" class="Function">even</a> <a id="634" href="Data.Binary.Conversion.Fast.html#608" class="Bound">n</a>
    <a id="640" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">then</a> <a id="645" href="Data.Binary.Definition.html#121" class="InductiveConstructor Operator">1ᵇ</a> <a id="648" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟦</a> <a id="650" href="Data.Binary.Conversion.Fast.html#401" class="Function">div2</a> <a id="655" href="Data.Binary.Conversion.Fast.html#608" class="Bound">n</a> <a id="657" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⇑⟧⟨</a> <a id="661" href="Data.Binary.Conversion.Fast.html#618" class="Bound">w</a> <a id="663" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟩</a>
    <a id="669" href="Data.Binary.Conversion.Fast.html#470" class="Function Operator">else</a> <a id="674" href="Data.Binary.Definition.html#125" class="InductiveConstructor Operator">2ᵇ</a> <a id="677" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟦</a> <a id="679" href="Data.Binary.Conversion.Fast.html#401" class="Function">div2</a> <a id="684" href="Data.Binary.Conversion.Fast.html#608" class="Bound">n</a> <a id="686" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⇑⟧⟨</a> <a id="690" href="Data.Binary.Conversion.Fast.html#618" class="Bound">w</a> <a id="692" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟩</a>
<a id="694" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟦</a> <a id="696" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="702" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⇑⟧⟨</a> <a id="706" class="Symbol">_</a>    <a id="711" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟩</a> <a id="713" class="Symbol">=</a> <a id="715" href="Data.Binary.Definition.html#112" class="InductiveConstructor">0ᵇ</a>
<a id="718" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟦</a> <a id="720" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="724" class="Symbol">_</a> <a id="726" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⇑⟧⟨</a> <a id="730" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="735" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟩</a> <a id="737" class="Symbol">=</a> <a id="739" href="Data.Binary.Definition.html#112" class="InductiveConstructor">0ᵇ</a> <a id="742" class="Comment">-- will not happen</a>

<a id="762" class="Comment">-- We build the output by repeatedly halving the input,</a>
<a id="818" class="Comment">-- but we also pass in the number to reduce as we go so that</a>
<a id="879" class="Comment">-- we satisfy the termination checker.</a>
<a id="⟦_⇑⟧"></a><a id="918" href="Data.Binary.Conversion.Fast.html#918" class="Function Operator">⟦_⇑⟧</a> <a id="923" class="Symbol">:</a> <a id="925" href="Agda.Builtin.Nat.html#192" class="Datatype">Nat</a> <a id="929" class="Symbol">→</a> <a id="931" href="Data.Binary.Definition.html#96" class="Datatype">𝔹</a>
<a id="933" href="Data.Binary.Conversion.Fast.html#918" class="Function Operator">⟦</a> <a id="935" href="Data.Binary.Conversion.Fast.html#935" class="Bound">n</a> <a id="937" href="Data.Binary.Conversion.Fast.html#918" class="Function Operator">⇑⟧</a> <a id="940" class="Symbol">=</a> <a id="942" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟦</a> <a id="944" href="Data.Binary.Conversion.Fast.html#935" class="Bound">n</a> <a id="946" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⇑⟧⟨</a> <a id="950" href="Data.Binary.Conversion.Fast.html#935" class="Bound">n</a> <a id="952" href="Data.Binary.Conversion.Fast.html#578" class="Function Operator">⟩</a>
<a id="954" class="Symbol">{-#</a> <a id="958" class="Keyword">INLINE</a> <a id="965" href="Data.Binary.Conversion.Fast.html#918" class="Function Operator">⟦_⇑⟧</a> <a id="970" class="Symbol">#-}</a>

</pre></body></html>